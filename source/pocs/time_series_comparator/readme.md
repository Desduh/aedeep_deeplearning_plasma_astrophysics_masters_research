# 📊 Comparing Synthetic P-model Data with Real Plasma Physics Time Series

**Author:** Carlos Eduardo Falandes  
**Institution:** INPE – Instituto Nacional de Pesquisas Espaciais

This project investigates how well synthetic time series generated by the **P-model** can replicate the statistical and dynamical characteristics of real-world plasma physics data (e.g., Tokamak heat flux, SDO solar observations, geomagnetic indices). The goal is to assess whether models trained on synthetic data can generalize to real experimental conditions.

---

## 🧠 Motivation

Real plasma data can be expensive, noisy, and limited in scope. The **P-model** generates multifractal time series controlled by a parameter `p`, simulating cascade-like energy distributions similar to turbulence. To ensure that machine learning models trained on synthetic data won't generalize poorly, we **quantitatively compare synthetic and real signals** across multiple dimensions.

---

## ✅ Workflow Summary

### 1. 📥 Dataset Loading
- Loads real time series (`tokamak`, `sdo`, `rho`) from CSV
- Applies `MinMaxScaler` to normalize values into `[0, 1]`

### 2. ⚗️ P-model Generation
- For each `p` in the range `[0.15, 0.45]`, a synthetic series is generated with reproducibility and peak thresholding

### 3. 📊 Time Series Comparison
Each real vs. synthetic comparison uses:

| Method | What It Measures | Interpretation |
|--------|------------------|----------------|
| **Basic Stats** | Mean, Std, Skewness, Kurtosis | Differences indicate statistical mismatch |
| **Sample Entropy** | Signal complexity / regularity | Closer values → similar irregularity |
| **KL Divergence** | Dissimilarity between PDFs | Low KL = similar distributions |
| **DFA (α exponent)** | Long-range correlation structure | Similar α → similar fractal scaling |
| **PSD (β exponent)** | Spectral decay of frequencies | Similar β → similar frequency dynamics |
| **Autocorrelation** | Memory/cycles in the signal | Similar decay → similar temporal structure |
| **KDE / Histogram** | Empirical distribution shape | Overlapping curves → similar distributions |
| **FFT (magnitude)** | Frequency components | Peaks in same location → shared periodicities |

These metrics are computed using the `TimeSeriesComparator` class and visualized as a function of `p`.

---

## 📉 How to Interpret the Outputs

- **Overlay plots**: visually compare the signals in time or frequency.
- **Horizontal red line**: marks the real signal’s metric for reference.
- **Black dashed line**: shows the absolute difference (`|Diff|`) between real and P-model metrics.
- **Metric convergence**: as p changes, convergence of curves toward the real value indicates **statistical similarity**.
- **KL ≈ 0**: means both distributions are very similar.
- **Entropy**: similar entropy means the complexity/unpredictability is preserved.
- **DFA exponent α**: relates to the presence of long-term correlations. If both series have similar α, they exhibit similar memory properties.
- **PSD exponent β**: linked to the scaling of frequency content. β ≈ 0 suggests white noise; β ≈ 2 suggests Brownian noise.

---

## 📦 Code Structure

| Module | Description |
|--------|-------------|
| `models/time_series_comparator.py` | All statistical, spectral, and entropy comparison tools |
| `models/pmodel_generation.py` | Generator of multifractal P-model series |
| `main_script.py` | Loads data, runs comparisons, and plots results |

---

## 📂 Project Layout

```
├── models/
│   ├── time_series_comparator.py
│   └── pmodel_generation.py
├── data/
│   ├── jorek/heat_flux_iter.csv
│   ├── sdo/sdo_time_series.csv
│   └── rho/ae_index_normalizado.csv
├── main_script.py
├── environment.yaml
└── README.md
```

---

## ⚙️ How to Run

### 1. Create and activate Conda environment
```bash
conda env create -f environment.yaml
conda activate plasma-env
```

### 2. Choose the dataset
Edit in `main_script.py`:
```python
series_key = "tokamak"  # or "sdo" or "rho"
```

### 3. Execute the script
```bash
python main_script.py
```

### 4. Explore the output
- 📈 Plots: distributions, FFT, ACF, DFA, PSD
- 📊 CSV: `<series_key>_pmodel_comparison_results.csv`
- 📋 Terminal report: summarized metrics and KL divergence

---

## 📬 Contact

For support, collaboration, or questions, contact:  
**Carlos Eduardo Falandes**  
📧 [carlos.falandes@inpe.br](mailto:carlos.falandes@inpe.br)

---

*This README was generated automatically with the help of ChatGPT*
