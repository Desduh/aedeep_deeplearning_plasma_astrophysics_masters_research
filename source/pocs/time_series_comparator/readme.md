# ğŸ“Š Comparing Synthetic P-model Data with Real Plasma Physics Time Series

**Author:** Carlos Eduardo Falandes  
**Institution:** INPE â€“ Instituto Nacional de Pesquisas Espaciais

This project investigates how well synthetic time series generated by the **P-model** can replicate the statistical and dynamical characteristics of real-world plasma physics data (e.g., Tokamak heat flux, SDO solar observations, geomagnetic indices). The goal is to assess whether models trained on synthetic data can generalize to real experimental conditions.

---

## ğŸ§  Motivation

Real plasma data can be expensive, noisy, and limited in scope. The **P-model** generates multifractal time series controlled by a parameter `p`, simulating cascade-like energy distributions similar to turbulence. To ensure that machine learning models trained on synthetic data won't generalize poorly, we **quantitatively compare synthetic and real signals** across multiple dimensions.

---

## âœ… Workflow Summary

### 1. ğŸ“¥ Dataset Loading
- Loads real time series (`tokamak`, `sdo`, `rho`) from CSV
- Applies `MinMaxScaler` to normalize values into `[0, 1]`

### 2. âš—ï¸ P-model Generation
- For each `p` in the range `[0.15, 0.45]`, a synthetic series is generated with reproducibility and peak thresholding

### 3. ğŸ“Š Time Series Comparison
Each real vs. synthetic comparison uses:

| Method | What It Measures | Interpretation |
|--------|------------------|----------------|
| **Basic Stats** | Mean, Std, Skewness, Kurtosis | Differences indicate statistical mismatch |
| **Sample Entropy** | Signal complexity / regularity | Closer values â†’ similar irregularity |
| **KL Divergence** | Dissimilarity between PDFs | Low KL = similar distributions |
| **DFA (Î± exponent)** | Long-range correlation structure | Similar Î± â†’ similar fractal scaling |
| **PSD (Î² exponent)** | Spectral decay of frequencies | Similar Î² â†’ similar frequency dynamics |
| **Autocorrelation** | Memory/cycles in the signal | Similar decay â†’ similar temporal structure |
| **KDE / Histogram** | Empirical distribution shape | Overlapping curves â†’ similar distributions |
| **FFT (magnitude)** | Frequency components | Peaks in same location â†’ shared periodicities |

These metrics are computed using the `TimeSeriesComparator` class and visualized as a function of `p`.

---

## ğŸ“‰ How to Interpret the Outputs

- **Overlay plots**: visually compare the signals in time or frequency.
- **Horizontal red line**: marks the real signalâ€™s metric for reference.
- **Black dashed line**: shows the absolute difference (`|Diff|`) between real and P-model metrics.
- **Metric convergence**: as p changes, convergence of curves toward the real value indicates **statistical similarity**.
- **KL â‰ˆ 0**: means both distributions are very similar.
- **Entropy**: similar entropy means the complexity/unpredictability is preserved.
- **DFA exponent Î±**: relates to the presence of long-term correlations. If both series have similar Î±, they exhibit similar memory properties.
- **PSD exponent Î²**: linked to the scaling of frequency content. Î² â‰ˆ 0 suggests white noise; Î² â‰ˆ 2 suggests Brownian noise.

---

## ğŸ“¦ Code Structure

| Module | Description |
|--------|-------------|
| `models/time_series_comparator.py` | All statistical, spectral, and entropy comparison tools |
| `models/pmodel_generation.py` | Generator of multifractal P-model series |
| `main_script.py` | Loads data, runs comparisons, and plots results |

---

## ğŸ“‚ Project Layout

```
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ time_series_comparator.py
â”‚   â””â”€â”€ pmodel_generation.py
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ jorek/heat_flux_iter.csv
â”‚   â”œâ”€â”€ sdo/sdo_time_series.csv
â”‚   â””â”€â”€ rho/ae_index_normalizado.csv
â”œâ”€â”€ main_script.py
â”œâ”€â”€ environment.yaml
â””â”€â”€ README.md
```

---

## âš™ï¸ How to Run

### 1. Create and activate Conda environment
```bash
conda env create -f environment.yaml
conda activate plasma-env
```

### 2. Choose the dataset
Edit in `main_script.py`:
```python
series_key = "tokamak"  # or "sdo" or "rho"
```

### 3. Execute the script
```bash
python main_script.py
```

### 4. Explore the output
- ğŸ“ˆ Plots: distributions, FFT, ACF, DFA, PSD
- ğŸ“Š CSV: `<series_key>_pmodel_comparison_results.csv`
- ğŸ“‹ Terminal report: summarized metrics and KL divergence

---

## ğŸ“¬ Contact

For support, collaboration, or questions, contact:  
**Carlos Eduardo Falandes**  
ğŸ“§ [carlos.falandes@inpe.br](mailto:carlos.falandes@inpe.br)

---

*This README was generated automatically with the help of ChatGPT*
